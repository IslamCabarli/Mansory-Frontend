<div class="min-h-screen bg-mansory-black">
  <!-- Admin Header -->
  <div class="bg-mansory-gray border-b border-mansory-light-gray">
    <div class="container-custom py-6">
      <div class="flex justify-between items-center">
        <div>
          <h1 class="text-3xl font-heading font-bold text-white mb-1">
            Admin <span class="text-mansory-gold">Dashboard</span>
          </h1>
          <p class="text-gray-400 text-sm">Welcome back, {{ authService.currentUser()?.name }}</p>
        </div>
        <div class="flex items-center space-x-4">
          <a routerLink="/home" class="text-gray-400 hover:text-white transition-colors text-sm">
            View Site
          </a>
          <button (click)="authService.logout()" class="btn-luxury-outline py-2 px-6 text-xs">
            Logout
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="container-custom py-8">
    <!-- View Switcher -->
    @if (activeView() === 'list') {
      <!-- Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-mansory-gray p-6 rounded-sm border border-mansory-light-gray">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-400 text-sm mb-1">Total Cars</p>
              <p class="text-3xl font-bold text-white">{{ cars().length }}</p>
            </div>
            <div class="w-12 h-12 bg-mansory-gold/10 rounded-full flex items-center justify-center">
              <svg class="w-6 h-6 text-mansory-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
              </svg>
            </div>
          </div>
        </div>

        <div class="bg-mansory-gray p-6 rounded-sm border border-mansory-light-gray">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-400 text-sm mb-1">Brands</p>
              <p class="text-3xl font-bold text-white">{{ brands().length }}</p>
            </div>
            <div class="w-12 h-12 bg-blue-500/10 rounded-full flex items-center justify-center">
              <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
              </svg>
            </div>
          </div>
        </div>

        <div class="bg-mansory-gray p-6 rounded-sm border border-mansory-light-gray">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-400 text-sm mb-1">Available</p>
              <p class="text-3xl font-bold text-white">
                {{ getAvailableCarsCount() }}
              </p>
            </div>
            <div class="w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center">
              <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions Bar -->
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-heading font-semibold text-white">Manage Cars</h2>
        <button (click)="showCreateForm()" class="btn-luxury flex items-center space-x-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
          </svg>
          <span>Add New Car</span>
        </button>
      </div>

      <!-- Cars Table -->
      @if (isLoading()) {
        <app-loader />
      } @else if (cars().length > 0) {
        <div class="bg-mansory-gray rounded-sm border border-mansory-light-gray overflow-hidden">
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead class="bg-mansory-light-gray">
                <tr>
                  <th class="px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Car</th>
                  <th class="px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Brand</th>
                  <th class="px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Price</th>
                  <th class="px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Status</th>
                  <th class="px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Year</th>
                  <th class="px-6 py-4 text-right text-xs font-semibold text-gray-400 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-mansory-light-gray">
                @for (car of cars(); track car.id) {
                  <tr class="hover:bg-mansory-light-gray transition-colors">
                    <td class="px-6 py-4">
                      <div class="flex items-center space-x-3">
                        <img [src]="getImageUrl(car)" alt="car.name" class="w-16 h-12 object-cover rounded"/>
                        <div>
                          <p class="text-white font-medium">{{ car.name }}</p>
                          @if (car.is_featured) {
                            <span class="text-xs text-mansory-gold">Featured</span>
                          }
                        </div>
                      </div>
                    </td>
                    <td class="px-6 py-4 text-gray-300">{{ car.brand?.name }}</td>
                    <td class="px-6 py-4 text-gray-300">
                      @if (car.price) {
                        {{ car.price | number:'1.0-0' }} {{ car.currency }}
                      } @else {
                        <span class="text-gray-500">N/A</span>
                      }
                    </td>
                    <td class="px-6 py-4">
                      <span [ngClass]="getStatusBadgeClass(car.status)" class="px-3 py-1 rounded-full text-xs font-semibold uppercase">
                        {{ car.status }}
                      </span>
                    </td>
                    <td class="px-6 py-4 text-gray-300">{{ car.registration_year }}</td>
                    <td class="px-6 py-4 text-right">
                      <div class="flex items-center justify-end space-x-2">
                        <button (click)="showEditForm(car)" class="text-blue-400 hover:text-blue-300 transition-colors p-2">
                          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                          </svg>
                        </button>
                        <button (click)="deleteCar(car)" class="text-red-400 hover:text-red-300 transition-colors p-2">
                          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                          </svg>
                        </button>
                      </div>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      } @else {
        <div class="text-center py-12 bg-mansory-gray rounded-sm border border-mansory-light-gray">
          <p class="text-gray-400">No cars found. Add your first car!</p>
        </div>
      }
    }

    <!-- Create/Edit Form -->
    @if (activeView() === 'create' || activeView() === 'edit') {
      <app-car-form 
        [car]="selectedCar()"
        [brands]="brands()"
        (saved)="onCarSaved()"
        (cancelled)="cancelForm()"
      />
    }
  </div>
</div>